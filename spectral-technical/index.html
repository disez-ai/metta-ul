
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://SNetGrant.github.io/metta-ul/spectral-technical/">
      
      
        <link rel="prev" href="../spectral-api-reference/">
      
      
        <link rel="next" href="../spectral-method/">
      
      
      <link rel="icon" href="../assets/favicon.ico">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.14">
    
    
      
        <title>Technical - Clustering Algorithms in MeTTa</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.342714a4.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="deep-orange">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#spectral-clustering-in-metta" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Clustering Algorithms in MeTTa" class="md-header__button md-logo" aria-label="Clustering Algorithms in MeTTa" data-md-component="logo">
      
  <img src="../assets/logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Clustering Algorithms in MeTTa
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Technical
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="deep-orange"  aria-hidden="true"  type="radio" name="__palette" id="__palette_0">
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="blue" data-md-color-accent="light-blue"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href=".." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
    
  
  
    
    
      
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../kmeans-api-reference/" class="md-tabs__link">
          
  
  
    
  
  Clustering

        </a>
      </li>
    
  

    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../visualization/" class="md-tabs__link">
          
  
  
    
  
  Guides

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Clustering Algorithms in MeTTa" class="md-nav__button md-logo" aria-label="Clustering Algorithms in MeTTa" data-md-component="logo">
      
  <img src="../assets/logo.png" alt="logo">

    </a>
    Clustering Algorithms in MeTTa
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Clustering
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Clustering
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1" >
        
          
          <label class="md-nav__link" for="__nav_2_1" id="__nav_2_1_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    KMeans
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1">
            <span class="md-nav__icon md-icon"></span>
            KMeans
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../kmeans-api-reference/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    API
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../kmeans-technical/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Technical
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2" >
        
          
          <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    GMM
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            GMM
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../gmm-api-reference/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    API
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../gmm-technical/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Technical
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3" checked>
        
          
          <label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Spectral
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2_3">
            <span class="md-nav__icon md-icon"></span>
            Spectral
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../spectral-api-reference/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    API
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Technical
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Technical
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#abstract" class="md-nav__link">
    <span class="md-ellipsis">
      Abstract
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    <span class="md-ellipsis">
      Introduction
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#algorithm-overview" class="md-nav__link">
    <span class="md-ellipsis">
      Algorithm Overview
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#metta-implementation-details" class="md-nav__link">
    <span class="md-ellipsis">
      MeTTa Implementation Details
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#comparison-with-scikitlearn" class="md-nav__link">
    <span class="md-ellipsis">
      Comparison with scikit‑learn
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#benchmark-setup" class="md-nav__link">
    <span class="md-ellipsis">
      Benchmark Setup
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#results" class="md-nav__link">
    <span class="md-ellipsis">
      Results
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#usage-example" class="md-nav__link">
    <span class="md-ellipsis">
      Usage Example
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#limitations-future-work" class="md-nav__link">
    <span class="md-ellipsis">
      Limitations &amp; Future Work
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#conclusion" class="md-nav__link">
    <span class="md-ellipsis">
      Conclusion
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#references" class="md-nav__link">
    <span class="md-ellipsis">
      References
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../spectral-method/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Method
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_4" >
        
          
          <label class="md-nav__link" for="__nav_2_4" id="__nav_2_4_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Bisecting
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_4">
            <span class="md-nav__icon md-icon"></span>
            Bisecting
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../bisecting-kmeans-api-reference/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    API
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../bisecting-kmeans-technical/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Technical
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_5" >
        
          
          <label class="md-nav__link" for="__nav_2_5" id="__nav_2_5_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Agglomerative
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_5">
            <span class="md-nav__icon md-icon"></span>
            Agglomerative
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../agglomerative-api-reference/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    API
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../agglomerative-technical/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Technical
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Guides
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Guides
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../visualization/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Virtualization
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#abstract" class="md-nav__link">
    <span class="md-ellipsis">
      Abstract
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    <span class="md-ellipsis">
      Introduction
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#algorithm-overview" class="md-nav__link">
    <span class="md-ellipsis">
      Algorithm Overview
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#metta-implementation-details" class="md-nav__link">
    <span class="md-ellipsis">
      MeTTa Implementation Details
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#comparison-with-scikitlearn" class="md-nav__link">
    <span class="md-ellipsis">
      Comparison with scikit‑learn
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#benchmark-setup" class="md-nav__link">
    <span class="md-ellipsis">
      Benchmark Setup
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#results" class="md-nav__link">
    <span class="md-ellipsis">
      Results
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#usage-example" class="md-nav__link">
    <span class="md-ellipsis">
      Usage Example
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#limitations-future-work" class="md-nav__link">
    <span class="md-ellipsis">
      Limitations &amp; Future Work
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#conclusion" class="md-nav__link">
    <span class="md-ellipsis">
      Conclusion
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#references" class="md-nav__link">
    <span class="md-ellipsis">
      References
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="spectral-clustering-in-metta">Spectral Clustering in MeTTa</h1>
<p><strong>Author:</strong> Ramin Barati, Amirhossein Nouranizadeh, Farhoud Mojahedzadeh<br />
<strong>Date:</strong> May 24, 2025<br />
<strong>Version:</strong> 1.0  </p>
<hr />
<h2 id="abstract">Abstract</h2>
<p>This report presents an open‑source implementation of spectral clustering in the MeTTa language. By leveraging MeTTa's declarative approach and NumPy bindings, we express graph‑based clustering via eigendecomposition of the Laplacian matrix. Our implementation constructs similarity graphs with RBF kernels, computes normalized Laplacians, and extracts low‑dimensional embeddings for k‑means partitioning. Benchmarks show competitive clustering quality with runtimes of ~1.1s versus scikit‑learn's ~0.05s, demonstrating MeTTa's capability to express complex mathematical algorithms while highlighting areas for optimization.</p>
<h2 id="introduction">Introduction</h2>
<p>Spectral clustering transforms data clustering into a graph partitioning problem, offering advantages over traditional methods for complex, non‑convex cluster shapes. Implementing spectral clustering in MeTTa:</p>
<ul>
<li>Demonstrates MeTTa's capability for linear algebra and eigendecomposition.  </li>
<li>Extends MeTTa's ML toolkit with a graph‑based clustering method.  </li>
<li>Provides a foundation for future spectral methods in MeTTa.  </li>
<li>Targets open‑source users in AI and Data Science.</li>
</ul>
<p>MeTTa is a multi‑paradigm language for declarative and functional computations over knowledge metagraphs. See http://www.metta‑lang.dev for details.</p>
<h2 id="algorithm-overview">Algorithm Overview</h2>
<p>Spectral clustering operates on the principle that cluster structure can be revealed through the spectrum (eigenvalues and eigenvectors) of a graph Laplacian derived from data similarities.</p>
<p>Key steps:</p>
<ol>
<li>
<p><strong>Similarity Graph Construction</strong>: Create an affinity matrix $W$ using a Gaussian kernel
   <div class="highlight"><pre><span></span><code>W_{ij} = \exp\left(-\frac{\|x_i - x_j\|^2}{2\sigma^2}\right)
</code></pre></div></p>
</li>
<li>
<p><strong>Laplacian Matrix</strong>: Compute the normalized Laplacian $L_{sym}$
   <div class="highlight"><pre><span></span><code>L_{sym} = I - D^{-1/2}WD^{-1/2}
</code></pre></div>
   where $D$ is the diagonal degree matrix with $D_{ii} = \sum_j W_{ij}$</p>
</li>
<li>
<p><strong>Spectral Embedding</strong>: Find the $k$ eigenvectors corresponding to the smallest eigenvalues of $L_{sym}$, forming a low‑dimensional embedding space.</p>
</li>
<li>
<p><strong>Clustering</strong>: Apply k‑means to the normalized rows of the eigenvector matrix.</p>
</li>
</ol>
<p>The algorithm exploits spectral graph theory: the multiplicity of the eigenvalue 0 equals the number of connected components, and the corresponding eigenvectors encode component membership.</p>
<h2 id="metta-implementation-details">MeTTa Implementation Details</h2>
<p>The MeTTa implementation utilizes NumPy bindings for matrix operations and eigendecomposition, with clear separation of algorithmic steps:</p>
<ol>
<li><strong>Affinity Matrix Construction</strong><br />
   First computes squared norms and pairwise distances, then applies RBF kernel:
   <div class="highlight"><pre><span></span><code>(spectral-clustering.rbf-affinity-matrix $sqr-distance-matrix-X $rbf-kernel-sigma)
</code></pre></div></li>
<li><strong>Time Complexity:</strong> O(n²·d) for distance matrix, O(n²) for kernel application.  </li>
<li>
<p><strong>Space Complexity:</strong> O(n²) for the affinity matrix.</p>
</li>
<li>
<p><strong>Degree Matrix and Laplacian</strong><br />
   Computes node degrees by summing affinities, then builds the normalized Laplacian:
   <div class="highlight"><pre><span></span><code>(spectral-clustering.normalized-laplacian $W $inverse-degree-matrix-W)
</code></pre></div></p>
</li>
<li><strong>Time Complexity:</strong> O(n²) for degree calculation, O(n³) for Laplacian normalization with matrix multiplication.  </li>
<li>
<p><strong>Space Complexity:</strong> O(n²) for the Laplacian.</p>
</li>
<li>
<p><strong>Eigendecomposition</strong><br />
   Extracts eigenvalues and eigenvectors of the Laplacian:
   <div class="highlight"><pre><span></span><code>(spectral-clustering.eigh $X)
</code></pre></div></p>
</li>
<li><strong>Time Complexity:</strong> O(n³) for full eigendecomposition.  </li>
<li>
<p><strong>Space Complexity:</strong> O(n²) for eigenvectors.</p>
</li>
<li>
<p><strong>Spectral Embedding</strong><br />
   Selects and normalizes eigenvectors for the k smallest eigenvalues:
   <div class="highlight"><pre><span></span><code>(spectral-clustering.row-normalize 
  (spectral-clustering.spectral-embeddings $eigh-I $k))
</code></pre></div></p>
</li>
<li><strong>Time Complexity:</strong> O(n·k) for selection and normalization.  </li>
<li>
<p><strong>Space Complexity:</strong> O(n·k) for the embedding.</p>
</li>
<li>
<p><strong>Clustering</strong><br />
   Applies k‑means to the normalized embeddings:
   <div class="highlight"><pre><span></span><code>(kmeans.fit $embeddings $num-clusters $max-kmeans-iter 0.0001)
</code></pre></div></p>
</li>
<li><strong>Time Complexity:</strong> O(t·n·k²) where t is iterations of k‑means.  </li>
<li>
<p><strong>Space Complexity:</strong> O(n·k) for assignments.</p>
</li>
<li>
<p><strong>Pipeline Integration</strong><br />
   The complete pipeline combines these steps in a nested let‑expression structure:
   <div class="highlight"><pre><span></span><code>(spectral-clustering.fit $X $num-clusters $rbf-kernel-sigma $max-kmeans-iter)
</code></pre></div></p>
</li>
<li><strong>Overall Time Complexity:</strong> O(n³) dominated by eigendecomposition.  </li>
<li>
<p><strong>Overall Space Complexity:</strong> O(n²) dominated by the affinity and Laplacian matrices.</p>
</li>
<li>
<p><strong>Prediction</strong><br />
   Assigns new data to clusters based on nearest centroids:
   <div class="highlight"><pre><span></span><code>(spectral-clustering.predict ($embeddings $centroids) $num-clusters)
</code></pre></div></p>
</li>
<li><strong>Time Complexity:</strong> O(n·k) for assignment calculation.  </li>
<li><strong>Space Complexity:</strong> O(n·k) for assignment matrix.</li>
</ol>
<p>The implementation handles the key algorithm steps declaratively, with eigendecomposition being the computational bottleneck for large datasets.</p>
<h2 id="comparison-with-scikitlearn">Comparison with scikit‑learn</h2>
<p>scikit‑learn's <code>SpectralClustering</code> offers more options and optimizations for larger datasets:</p>
<table>
<thead>
<tr>
<th>Feature</th>
<th>MeTTa Implementation</th>
<th>scikit‑learn</th>
</tr>
</thead>
<tbody>
<tr>
<td>Affinity methods</td>
<td>RBF kernel only</td>
<td>RBF, nearest neighbors, precomputed</td>
</tr>
<tr>
<td>Laplacian types</td>
<td>normalized symmetric</td>
<td>normalized, unnormalized, random walk</td>
</tr>
<tr>
<td>Eigensolvers</td>
<td>full decomposition via NumPy</td>
<td>ARPACK, LOBPCG, AMG (sparse options)</td>
</tr>
<tr>
<td>Scaling techniques</td>
<td>none</td>
<td>Nyström method for large datasets</td>
</tr>
<tr>
<td>Final clustering</td>
<td>k‑means only</td>
<td>k‑means or discretization</td>
</tr>
<tr>
<td>Implementation</td>
<td>declarative with NumPy bindings</td>
<td>optimized C/Cython with specialized solvers</td>
</tr>
</tbody>
</table>
<p>The MeTTa implementation provides core functionality while scikit‑learn offers additional options for scalability and customization.</p>
<h2 id="benchmark-setup">Benchmark Setup</h2>
<ul>
<li><strong>Datasets</strong> (500 samples each, synthetic generation via scikit‑learn):</li>
<li><code>noisy_moons</code>: Two interleaving half‑circles</li>
<li><code>varied</code>: Varied variance blobs</li>
<li><code>no_structure</code>: Random noise</li>
<li><strong>Environment</strong>: CPU = 4 cores @ 3.0 GHz, Hyperon 0.2.2, NumPy 2.2.2, scikit‑learn 1.6.1</li>
</ul>
<h2 id="results">Results</h2>
<p>Performance comparison:</p>
<table>
<thead>
<tr>
<th>Dataset</th>
<th>Time (s)</th>
<th>Silhouette</th>
<th>Calinski-Harabasz</th>
<th>Davies-Bouldin</th>
<th>ARI</th>
<th>NMI</th>
<th>AMI</th>
</tr>
</thead>
<tbody>
<tr>
<td>no-structure</td>
<td>0.69</td>
<td>0.370</td>
<td>359.72</td>
<td>0.863</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<td>blobs</td>
<td>1.57</td>
<td>0.457</td>
<td>268.15</td>
<td>0.594</td>
<td>0.568</td>
<td>0.729</td>
<td>0.728</td>
</tr>
<tr>
<td>noisy_circles</td>
<td>1.18</td>
<td>0.114</td>
<td>0.0077</td>
<td>240.59</td>
<td>1.000</td>
<td>1.000</td>
<td>1.000</td>
</tr>
<tr>
<td>noisy_moon</td>
<td>0.73</td>
<td>0.385</td>
<td>429.54</td>
<td>1.028</td>
<td>1.000</td>
<td>1.000</td>
<td>1.000</td>
</tr>
<tr>
<td>varied</td>
<td>0.76</td>
<td>0.627</td>
<td>1474.97</td>
<td>0.642</td>
<td>0.843</td>
<td>0.828</td>
<td>0.827</td>
</tr>
</tbody>
</table>
<h2 id="usage-example">Usage Example</h2>
<div class="highlight"><pre><span></span><code>(import! &amp;self metta_ul) 
(import! &amp;self spectral-clustering)

(let 
    $labels 
    (spectral-clustering.predict $fit-outputs 2)
    (println! $labels)
)
</code></pre></div>
<p>This snippet:
1. Imports required modules
2. Fits spectral clustering with <code>k=2</code> clusters
3. Predicts cluster assignments
4. Prints the resulting labels</p>
<h2 id="limitations-future-work">Limitations &amp; Future Work</h2>
<ul>
<li><strong>Scalability</strong>: The O(n²) memory requirement for the affinity matrix and O(n³) time complexity for eigendecomposition limit scaling to large datasets.</li>
<li><strong>Affinity options</strong>: Currently only supports RBF kernel; could add nearest‑neighbor and custom affinities.</li>
<li><strong>Eigensolver efficiency</strong>: Could integrate specialized solvers like ARPACK for large sparse matrices.</li>
<li><strong>Hyperparameter selection</strong>: Automatic sigma estimation for the RBF kernel would improve usability.</li>
<li><strong>Alternative Laplacians</strong>: Add unnormalized and random walk variants.</li>
</ul>
<h2 id="conclusion">Conclusion</h2>
<p>The MeTTa implementation of spectral clustering demonstrates the language's capability to express complex numerical algorithms declaratively. Despite performance differences compared to optimized C/Cython code, the implementation achieves excellent clustering quality on non‑convex datasets. The clear functional decomposition allows for future extensions and optimizations while serving as a reference for spectral methods in MeTTa.</p>
<h2 id="references">References</h2>
<ol>
<li>Ng, Jordan, Weiss (2002). On Spectral Clustering: Analysis and an Algorithm.</li>
<li>von Luxburg (2007). A Tutorial on Spectral Clustering.</li>
<li>Pedregosa et al. (2011). scikit‑learn: Machine Learning in Python.</li>
<li>MeTTa Language Specification. http://www.metta‑lang.dev/spec</li>
</ol>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/SNetGrant/metta-ul" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "..", "features": ["navigation.tabs", "navigation.sections", "search.suggest", "search.highlight", "search.share", "navigation.indexes", "toc.follow"], "search": "../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.13a4f30d.min.js"></script>
      
    
  </body>
</html>